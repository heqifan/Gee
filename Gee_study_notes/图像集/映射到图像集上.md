# 图像集映射

#

要将函数应用到ImageCollection中的每个Image，请使用ImageCollection .map()。map()的唯一实参是一个接受一个形参的函数:ee.Image。例如，以下代码将时间戳带添加到集合中的每个图像:

```python
# 装载一个单一路径行Landsat 8集合。
collection = ee.ImageCollection('LANDSAT/LC08/C01/T1_TOA')
  .filter(ee.Filter.eq('WRS_PATH', 44))
  .filter(ee.Filter.eq('WRS_ROW', 34))

# 这个函数添加一个表示图像时间戳的波段。
addTime = function(image) {
  return image.addBands(image.metadata('system:time_start'))
}

#将函数映射到集合上并显示结果。
print(collection.map(addTime))
```



注意，在预定义的函数中，元数据()方法用于从属性的值创建一个新的Image。正如在减少和合成部分中所讨论的，拥有这个时间范围对于变化的线性建模和合成是有用的。

映射函数只能执行有限的操作。具体来说，它不能修改函数之外的变量;它不能打印任何东西;它不能使用JavaScript的' if '或' for '语句。但是，你可以使用ee.Algorithms.If()在映射函数中执行条件操作。例如:

```javascript
// 装载一个单一路径行Landsat 8集合。
var collection = ee.ImageCollection('LANDSAT/LC8_L1T_TOA')
  .filter(ee.Filter.eq('WRS_PATH', 44))
  .filter(ee.Filter.eq('WRS_ROW', 34));

// 该函数使用条件语句返回图像if
// 太阳高度> 40度。否则它将返回一个零图像。
var conditional = function(image) {
  return ee.Algorithms.If(ee.Number(image.get('SUN_ELEVATION')).gt(40),
                          image,
                          ee.Image(0));
};

// 将函数映射到集合上，转换为List并打印结果。
print('Expand this to see the result: ', collection.map(conditional));
```

检查输出ImageCollection中的图像列表，注意当If()算法计算的条件为真时，输出包含一个常量图像。尽管这演示了一个服务器端条件函数(在Earth Engine中了解更多关于客户端与服务器的知识)，但通常要避免使用If()，而使用过滤器。

