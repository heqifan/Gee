# Image Visualization

## 一.图像可视化参数

![image-20210802101831106](C:\Users\树风\AppData\Roaming\Typora\typora-user-images\image-20210802101831106.png)

bands(列表):物体反射出的光在不同波段的大小（值）是不一样的，这样再设置不同波段的颜色，以及颜色的范围，就可以将不同物体区分开来，就可以形成想要的图层。

min(数字或三个数字的列表) : 对应波段颜色设置的最小值

max(数字或三个数字的列表) : 对应波段颜色设置的最大值

gain(数字或三个数字的列表) : 要乘以每个像素值的值(用与像素值过大或过小的图层)

gamma(数字或三个数字的列表) : 灰度系数，灰度系数与黑色和白色的差别成反比

palette(列表) : ss风格的颜色字符串列表(仅限单波段图像)，逗号分隔的十六进制字符串列表

opacity(数字) : 图层的不透明度(0.0是完全透明，1.0是完全不透明)

format(字符串) : “jpg”或“png”

## 二.RGB composites(RGB合成)

下面举例说明如何使用参数将Landsat 8图像作为伪彩色合成:

```python
# Load an image.
image = ee.Image('LANDSAT/LC08/C01/T1_TOA/LC08_044034_20140318')

# Define the visualization parameters.
image_viz_params = {
    'bands': ['B5', 'B4', 'B3'],
    'min': 0,
    'max': 0.5,
    'gamma': [0.95, 1.1, 1]
}

#定义一张以旧金山湾为中心的地图。
map_l8 = folium.Map(location=[37.5010, -122.1899], zoom_start=10)

#添加图像图层到地图并显示它。
map_l8.add_ee_layer(image, image_viz_params, 'false color composite')
display(map_l8)
```

在这个例子中，'B5'被分配到红色，'B4'被分配到绿色，'B3'被分配到蓝色。

![false_color_sf](https://developers.google.com/earth-engine/images/Images_false_color_sf.png)

美国加利福尼亚州旧金山湾区陆地卫星8号的假彩色合成图。

## 三.Color palettes(颜色画板)

要以颜色显示图像的单个条带，请使用css样式的颜色字符串列表表示的颜色渐变设置调色板参数。下面的示例演示了如何使用从青色('00FFFF')到蓝色('0000FF')的颜色来渲染归一化差水指数(NDWI)图像:

```python
# 载入一副图像.
image = ee.Image('LANDSAT/LC08/C01/T1_TOA/LC08_044034_20140318')

# 创建一个NDWI图像，定义可视化参数和显示。
ndwi = image.normalizedDifference(['B3', 'B5'])
ndwi_viz = {'min': 0.5, 'max': 1, 'palette': ['00FFFF', '0000FF']}

# 定义一张以旧金山湾为中心的地图。
map_ndwi = folium.Map(location=[37.5010, -122.1899], zoom_start=10)

# 添加图像图层到地图并显示它.
map_ndwi.add_ee_layer(ndwi, ndwi_viz, 'NDWI')
display(map_ndwi)
```

在本例中，请注意，min和max参数指示了调色板应应用的像素值范围。中间值是线性拉伸的。

![ndwi_sf](https://developers.google.com/earth-engine/images/Images_NDWI_sf.png)

Landsat 8 NDWI，美国旧金山湾区。青色是低值，蓝色是高值。

## 四.Masking(掩码)

可以使用image. updatemask()根据掩码图像中像素非零的位置来设置各个像素的不透明度。在蒙版中等于0的像素将被排除在计算之外，并且显示时不透明度设置为0。下面的示例使用NDWI阈值来更新之前创建的NDWI层的掩码:

```python
# 遮罩图像的非水部分，其中NDWI < 0.4。
ndwi_masked = ndwi.updateMask(ndwi.gte(0.4))

# 定义一张以旧金山湾为中心的地图。
map_ndwi_masked = folium.Map(location=[37.5010, -122.1899], zoom_start=10)

# 添加图像图层到地图并显示它。
map_ndwi_masked.add_ee_layer(ndwi_masked, ndwi_viz, 'NDWI masked')
display(map_ndwi_masked)
```



## 五.Visualization images

使用image.visualize()方法将图像转换为8位RGB图像以便显示或导出。例如，要将伪色合成和NDWI转换为3波段显示图像，请使用:

```python
image_rgb = image.visualize(**{'bands': ['B5', 'B4', 'B3'], 'max': 0.5})
ndwi_rgb = ndwi_masked.visualize(**{
    'min': 0.5,
    'max': 1,
    'palette': ['00FFFF', '0000FF']
})
```



## 六.Mosaicking(镶嵌)

您可以使用masking和imageCollection.mosaic()来实现各种不同的地图效果。mosaic()方法根据各层在输入集合中的顺序在输出图像中呈现。下面的例子使用mosaic()来组合蒙版NDWI和假颜色组合，并获得新的可视化结果:

```python
# Mosaic the visualization layers and display (or export).
mosaic = ee.ImageCollection([image_rgb, ndwi_rgb]).mosaic()

# Define a map centered on San Francisco Bay.
map_mosaic = folium.Map(location=[37.5010, -122.1899], zoom_start=10)

# Add the image layer to the map and display it.
map_mosaic.add_ee_layer(mosaic, None, 'mosaic')
display(map_mosaic)
```

在本例中，可以看到ImageCollection构造函数提供了两个可视化图像的列表。列表的顺序决定了图像在地图上呈现的顺序。

![mosaic_sf](https://developers.google.com/earth-engine/images/Images_mosaic_sf.png)

陆地卫星8假彩色合成和NDWI的镶嵌图。美国旧金山湾区。

## 七.Clipping(裁剪)

```python
# 通过在一个点周围画一个20000米的缓冲区来创建一个圆。
roi = ee.Geometry.Point([-122.4481, 37.7599]).buffer(20000)
mosaic_clipped = mosaic.clip(roi)

# 定义一张以旧金山为中心的地图。
map_mosaic_clipped = folium.Map(location=[37.7599, -122.4481], zoom_start=10)

#添加图像图层到地图并显示它。
map_mosaic_clipped.add_ee_layer(mosaic_clipped, None, 'mosaic clipped')
display(map_mosaic_clipped)
```

在前面的示例中，请注意，坐标被提供给了Geometry构造函数，并且缓冲区长度被指定为20,000米。在“几何图形”页了解有关几何图形的更多信息。

![clipped_sf](https://developers.google.com/earth-engine/images/Images_clip_SF_map.png)

上图所示的嵌合体，夹在美国加州旧金山附近的一个缓冲区上。

## 八.Rendering categorical maps(呈现分类地图)

调色板对于呈现离散的有价值地图也很有用，例如土地覆盖地图。在有多个类的情况下，使用调色板为每个类提供不同的颜色。(image.remap()方法在这种上下文中可能很有用，可以将任意标签转换为连续整数)。下面的例子使用调色板来渲染土地覆盖类别:

```python
# 加载2012年MODIS土地覆盖，选择IGBP分类。
cover = ee.Image('MODIS/051/MCD12Q1/2012_01_01').select('Land_Cover_Type_1')

# 为18个不同的土地覆盖类别定义一个调色板。
igbp_palette = [
    'aec3d4',  # water
    '152106',
    '225129',
    '369b47',
    '30eb5b',
    '387242',  # forest
    '6a2325',
    'c3aa69',
    'b76031',
    'd9903d',
    '91af40',  # shrub, grass
    '111149',  # wetlands
    'cdb33b',  # croplands
    'cc0013',  # urban
    '33280d',  # crop mosaic
    'd7cdcc',  # snow and ice
    'f7e084',  # barren
    '6f6f6f'   # tundra
]

#：定义一张以美国为中心的地图。
map_palette = folium.Map(location=[40.413, -99.229], zoom_start=5)

# 添加图像图层到地图并显示它。指定最小和最大标签
#和与标签匹配的调色板。进入翻译页面
map_palette.add_ee_layer(
    cover, {'min': 0, 'max': 17, 'palette': igbp_palette}, 'IGBP classes')
display(map_palette)
```

![landcover_palettized](https://developers.google.com/earth-engine/images/Images_landcover_palettized.png)

基于IGBP的MODIS 2012土地覆盖分类。

## 九.Thumbnail images(定义小照片图像)

使用电子地球仪。Getthumburl ()方法为 ee 生成 PNG 或 JPEG 缩略图。图像对象。打印以调用 getThumbURL ()结尾的表达式的结果将导致打印 URL。访问 URL 将使地球引擎服务器动态生成请求的缩略图。处理完成后，图像将在浏览器中显示。可以通过从图片的右键菜单中选择合适的选项来下载。

![thumbnail_in_browser](https://developers.google.com/earth-engine/images/Images_thumbnail.png)

SRTM数字高程模型在浏览器中显示为PNG缩略图。

getThumbURL()方法包含参数，在上面的可视化参数表中进行了描述。此外，它还接受可选的尺寸、区域和crs参数，这些参数控制缩略图的空间范围、大小和显示投影。

(ee.Image.getThumbURL()的附加参数和格式说明)

![image-20210802143422113](C:\Users\树风\AppData\Roaming\Typora\typora-user-images\image-20210802143422113.png)

dimensions('WIDTHxHEIGHT'格式的单个整数或字符串:) : 以像素为单位的缩略图尺寸。如果提供了单个整数，它将定义图像维度的大小，并按比例缩放维度。对于较大的图像维度，默认为512像素。

region(GeoJSON或至少三个点坐标定义线性环的二维列表) : 

要渲染的图像的地理空间区域。默认情况下整个图像，或提供的几何体的边界。

crs(字符串): 目标投影“EPSG: 3857”。默认为WGS84 ('EPSG:4326')。

format (字符串;png或jpg格式): 将缩略图格式定义为PNG或JPEG。默认的PNG格式被实现为RGBA，其中alpha通道表示有效和无效像素，由图像的mask()定义。无效像素是透明的。可选的JPEG格式实现为RGB，其中无效图像像素在RGB通道中填充为零。

## 学到了：

​					1.对图像可视化的一些操作

